alias printer r11
alias receta r10
alias printerId r12
alias cantidad r13
alias temp r14
alias pedir r15

#necesito un maquina, cualquiera que haga la conversion de ingrediente a HASH
alias torno d0

sbn HASH("StructureChuteDigitalFlipFlopSplitterRight") HASH("hid") Setting 0
sbn HASH("StructureChuteDigitalFlipFlopSplitterRight") HASH("ele") Setting 0

main:
yield
#si alguno de los dos es cero no puedo crear nada
lbn r0 HASH("StructureLogicMemory") HASH("maquina") Setting Minimum
lbn r1 HASH("StructureLogicMemory") HASH("cantidad") Setting Minimum
beqz r0 main
beqz r1 main
#si los dos no son cero los leo
move printer r0
move cantidad r1
#y los borro para no leerlos sin querer
sbn HASH("StructureLogicMemory") HASH("maquina") Setting 0
sbn HASH("StructureLogicMemory") HASH("cantidad") Setting 0
#guardo el id de la impresora y el hashde la receta que esta seleccionada
lb printerId printer ReferenceId Minimum
lb receta printer RecipeHash Minimum
#muestro el has de la receta y limpio los otros
sbn HASH("StructureLogicMemory") HASH("mat1") Setting receta
sbn HASH("StructureLogicMemory") HASH("mat2") Setting 0
sbn HASH("StructureLogicMemory") HASH("mat3") Setting 0
sbn HASH("StructureLogicMemory") HASH("mat4") Setting 0
sbn HASH("StructureLogicMemory") HASH("mat5") Setting 0
sbn HASH("StructureLogicMemory") HASH("mat6") Setting 0
#en cuanto tengas los ingreditente imprimi
or r0 0 PrinterInstruction.WaitUntilNextValid
clrd printerId
putd printerId 1 r0
#ejecuteo la receta con la configuracion eleccionada para eso hayq ue aramr la instruccion
#es un numero de 32 bytes, 8 para la orden, 8 para la cantidad y 16 para la receta,
#supongoamos 2 puertas (hash 168615924, en heagesimal A0CDFF4) el numero seria
# 0000 0002 0000 0008 0A0C DFF4
sll r1 cantidad 8
#genera 1111 1111 0000 0008 1111 1111 la cantidadd del byte 8 al 15
sll r2 receta 16
#genera 1111 1111 1111 1111 0A0C DFF4 el receta del btye 16 al 31
or r1 r1 r2
#genera 1111 1111 0000 0008 0A0C DFF4 los agrega
or r1 r1 PrinterInstruction.ExecuteRecipe
#genera 0000 0002 0000 0008 0A0C DFF4 agrega el 2 como viene orqeu esta al principio
#el numero va en el OP2 de la maquina
putd printerId 2 r1
sleep 1
#luego puedo leer los ingredientes (no vi recetas de mas de 8 ingredientes)
#en la posicion 54 en adelante estan los ingredientes
getd temp printerId 54
#quito los primeros 16 bites que son el codigo de operacion y la cnatidad, los ignoro
sra temp temp 16
#conveirte de ingrediente a hash
rmap temp torno temp
#lo pongo en la memoria para que aparezca en la pantalla
sbn HASH("StructureLogicMemory") HASH("mat2") Setting temp
#se lo pdio a la expendedora
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
#repito para todas las siguientes
getd temp printerId 55
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureLogicMemory") HASH("mat3") Setting temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
getd temp printerId 56
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureLogicMemory") HASH("mat4") Setting temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
getd temp printerId 57
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureLogicMemory") HASH("mat5") Setting temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
getd temp printerId 58
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureLogicMemory") HASH("mat6") Setting temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
#solo muestro 5, en adelante no los muestro
getd temp printerId 59
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
getd temp printerId 60
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureVendingMachine") HASH("fabricadores") RequestHash temp
sleep 1
getd temp printerId 61
sra temp temp 16
rmap temp torno temp
sbn HASH("StructureVendingMachine") HASH("
